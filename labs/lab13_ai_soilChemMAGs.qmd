---
title: "Lab 13 - Creating a detailed report with explanations from the NEON MAG data"
---

## Overview

In lab 7 we asked you to load `NEON_soilMAGs_soilChem.csv` file into co-pilot. Then ask for suggestions in the types of analysis you can do. Here were some possibilies co-pilot gave me. 

1. Community Composition & Diversity

-  Taxonomic profiling: Summarize relative abundances of phyla, classes, or genera across sites.
-  Alpha diversity: Compute metrics like Shannon, Simpson, and richness for each site.
-  Beta diversity: Compare community composition between sites using Bray-Curtis or UniFrac distances.
-  Ordination: Perform PCA, NMDS, or PCoA to visualize differences in microbial communities.

2. Environmental Correlations

-  Soil chemistry vs. taxonomy: Correlate pH, moisture, temperature, and elevation with microbial diversity or specific taxa.
-  Gradient analysis: Identify taxa enriched along environmental gradients (e.g., moisture or pH).
-  Canonical Correspondence Analysis (CCA): Link community composition to environmental variables.

3. Biogeography & Spatial Patterns

-  Mapping taxa distributions: Visualize where specific taxa or functional groups occur across latitude/longitude.
-  Spatial autocorrelation: Test if microbial communities are structured by geography.
-  Distance-decay analysis: Examine how community similarity decreases with geographic distance.

4. Co-occurrence & Network Analysis

-  Microbial interaction networks: Build co-occurrence networks to identify potential ecological interactions.
-  Module detection: Identify clusters of taxa that respond similarly to environmental factors.

Ask co-pilot for guidance and code in doing your analysis. As with last week this is an open ended lab. The expectations are that you spend class time exploring one of these areas and submit a lab report with your code.

Here is an example co-pilot prompt that could be used to start getting results and graphs related to this categories

This is a table Metagenome assembled genomes (MAGS) from metagenomes from sites that are part of the National Ecological Observatory Network. The table includes information on the MAGs including their taxonomy and quality measures. It also includes soil chemistry data associated with each metagenome. At each site there are 1 or more subplots. The string in the column genomesSampleID includes the siteID, the subplot number, the soil layer (O or M) and the date collected. Could you create a tutorial in a R markdown notebook including plots and explanations using Tidverse and other packages to understand Community Composition & Diversity including

-  Taxonomic profiling: Summarize relative abundances of phyla, classes, or genera across sites.
-  Alpha diversity: Compute metrics like Shannon, Simpson, and richness for each site.
-  Beta diversity: Compare community composition between sites using Bray-Curtis or UniFrac distances.
-  Ordination: Perform PCA, NMDS, or PCoA to visualize differences in microbial communities.

After several iterations including error fixes, the following results were obtained for each category within 30 minutes. 

1. [Community Composition & Diversity](NEON_MAGs_Community_Analysis_By_SiteID.html)
2. [Environmental Correlations](NEON_MAGs_Environmental_Correlations.html)
3. [Biogeography & Spatial Patterns](NEON_MAGs_Biogeography_Comprehensive.html)
4. [Co-occurrence & Network Analysis](NEON_MAGs_microbial_network_analysis_comprehensive.html)

* There are some important limitations to our data set to keep in mind for these analyses. We have only a list of the MAGs, not their abundance at a particular site. To get the abundance we would need to map the reads from the unassembled metagenome to get a count of the number of reads from each MAG. This is a proxy for the number of counts for each genome. In the above code the counts are coming from the number of different taxa in each category.

## Exercises

1. Start by saving a .qmd file for Lab 13 to the folder that represents your GitHub directory. From your index.qmd file create a link to the rendered html version of Lab 13. Push these changes to your GitHub repository and make sure you can see the linked version of Lab 13.

2. Upload to co-pilot the `NEON_soilMAGs_soilChem.csv` file. Then ask for suggestions in the types of analysis you can do or create a prompt using one of the four categories above.

3. Iterate with co-pilot to create a comprehensive analysis of the category area. 

4. Add explanations for the different types of analyses. For example what is Shannon Diversity?  The final report should be something you could give another student or person in your lab.

5. Push the final report to GitHub. Submit a link to your website (not your repository)
